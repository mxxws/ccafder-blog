@echo off
:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
:: Hugo è‡ªåŠ¨åŒ–éƒ¨ç½²è„šæœ¬ (ä¼˜åŒ–ç‰ˆ)
:: åŠŸèƒ½ï¼šå¸¦ç¾Žè§‚æç¤ºçš„ git æ“ä½œæµç¨‹
:: ç¼–ç ï¼šUTF-8 with BOMï¼ˆå®Œç¾Žå…¼å®¹ä¸­æ–‡ï¼‰
:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::

chcp 65001 > nul
setlocal enabledelayedexpansion
title ðŸ› ï¸ Hugo éƒ¨ç½²åŠ©æ‰‹
color 0B

:: ç”Ÿæˆæ—¶é—´æˆ³
set "DATE_STAMP=%DATE:/=-%"
set "TIME_STAMP=%TIME::=-%"
set "TIMESTAMP=!DATE_STAMP:~0,10!_!TIME_STAMP:~0,8!"

:: ä¸»æµç¨‹
echo.
echo =========================================================================
echo               HUGO è‡ªåŠ¨åŒ–éƒ¨ç½²å·¥å…·
echo =========================================================================
echo å¼€å§‹æ—¶é—´ï¼š!TIMESTAMP!
echo.

:: æ­¥éª¤1ï¼šæ·»åŠ æ–‡ä»¶
echo æ­¥éª¤ 1/3  æ‰«ææ–‡ä»¶å˜æ›´...
git add . || goto error_handling
echo [âˆš] æ£€æµ‹åˆ° !errorlevel! ä¸ªæ–‡ä»¶å˜æ›´

:: æ­¥éª¤2ï¼šæœ¬åœ°æäº¤
echo æ­¥éª¤ 2/3  ç”Ÿæˆæäº¤è®°å½•...
git commit -m "AutoDeploy: !TIMESTAMP!" || goto error_handling
echo [âˆš] æäº¤æè¿°ï¼š!TIMESTAMP!

:: æ­¥éª¤3ï¼šæŽ¨é€åˆ°GitHub
echo æ­¥éª¤ 3/3  åŒæ­¥åˆ°äº‘ç«¯...
git push origin main || goto error_handling
echo [âˆš] å·²æŽ¨é€è‡³ origin/main åˆ†æ”¯

:: æˆåŠŸå®Œæˆæç¤º
echo.
echo =========================================================================
echo                   æ‰€æœ‰æ“ä½œå·²å®Œæˆï¼
echo =========================================================================
echo æŒ‰ä»»æ„é”®å…³é—­çª—å£...
pause > nul
exit /b 0

:: é”™è¯¯å¤„ç†æ¨¡å—
:error_handling
echo.
echo =========================================================================
echo                     æ‰§è¡Œè¿‡ç¨‹é‡åˆ°é”™è¯¯
echo =========================================================================
echo é”™è¯¯ä»£ç ï¼š!errorlevel!
echo å¯èƒ½åŽŸå› ï¼š
echo 1. æ— æ–‡ä»¶å˜æ›´ (ä»£ç 1)
echo 2. ç½‘ç»œè¿žæŽ¥å¤±è´¥ (ä»£ç 128)
echo 3. èº«ä»½éªŒè¯å¤±è´¥ (ä»£ç 403)
echo =========================================================================
echo æŒ‰ä»»æ„é”®æŸ¥çœ‹è§£å†³æ–¹æ¡ˆå»ºè®®...
pause > nul
exit /b 1